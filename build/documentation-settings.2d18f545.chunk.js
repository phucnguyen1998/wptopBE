"use strict";(self.webpackChunkbe=self.webpackChunkbe||[]).push([[8503],{31346:(S,d,t)=>{t.r(d),t.d(d,{default:()=>A});var e=t(67294),c=t(97132),g=t(80831),i=t(95489),s=t(28702),m=t(41363),y=t(80826),l=t(93742),T=t(4733),v=t(27821);const n=(0,v.default)(s.FieldAction)`
  svg {
    height: 1rem;
    width: 1rem;
    path {
      fill: ${({theme:a})=>a.colors.neutral600};
    }
  }
`;var p=t(53209);const h=p.Ry().shape({restrictedAccess:p.O7(),password:p.Z_().when("restrictedAccess",(a,u)=>a?u.required(i.translatedErrors.required):u)}),A=()=>{(0,i.useFocusWhenNavigate)();const{formatMessage:a}=(0,c.useIntl)(),{submitMutation:u,data:r,isLoading:M}=(0,T.Z)(),[P,I]=(0,e.useState)(!1),L=w=>{u.mutate({prefix:r?.prefix,body:w})};return e.createElement(s.Main,null,M?e.createElement(i.LoadingIndicatorPage,null,"Plugin settings are loading"):e.createElement(g.Formik,{initialValues:{restrictedAccess:r?.documentationAccess.restrictedAccess||!1,password:""},onSubmit:L,validationSchema:h},({handleSubmit:w,values:f,handleChange:R,errors:C,setFieldTouched:b,setFieldValue:D})=>e.createElement(i.Form,{noValidate:!0,onSubmit:w},e.createElement(s.HeaderLayout,{title:a({id:(0,l.O)("plugin.name"),defaultMessage:"Documentation"}),subtitle:a({id:(0,l.O)("pages.SettingsPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:e.createElement(i.CheckPermissions,{permissions:y.Z.update},e.createElement(s.Button,{type:"submit",startIcon:e.createElement(m.Check,null)},a({id:(0,l.O)("pages.SettingsPage.Button.save"),defaultMessage:"Save"})))}),e.createElement(s.ContentLayout,null,e.createElement(s.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(s.Stack,{spacing:4},e.createElement(s.Typography,{variant:"delta",as:"h2"},a({id:"global.settings",defaultMessage:"Settings"})),e.createElement(s.Grid,{gap:4},e.createElement(s.GridItem,{col:6,s:12},e.createElement(s.ToggleInput,{name:"restrictedAccess",label:a({id:(0,l.O)("pages.SettingsPage.toggle.label"),defaultMessage:"Restricted Access"}),hint:a({id:(0,l.O)("pages.SettingsPage.toggle.hint"),defaultMessage:"Make the documentation endpoint private"}),checked:f.restrictedAccess,onChange:()=>{f.restrictedAccess===!0&&(D("password","",!1),b("password",!1,!1)),D("restrictedAccess",!f.restrictedAccess,!1)},onLabel:"On",offLabel:"Off"})),f.restrictedAccess&&e.createElement(s.GridItem,{col:6,s:12},e.createElement(s.TextInput,{label:a({id:"global.password",defaultMessage:"Password"}),name:"password",placeholder:"**********",type:P?"text":"password",value:f.password,onChange:R,error:C.password?a({id:C.password,defaultMessage:"Invalid value"}):null,endAction:e.createElement(n,{onClick:Z=>{Z.stopPropagation(),I($=>!$)},label:a(P?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},P?e.createElement(m.Eye,null):e.createElement(m.EyeStriked,null))})))))))))}},4733:(S,d,t)=>{t.d(d,{Z:()=>v});var e=t(23724),c=t(95489),g=t(49950);const i=({prefix:o,version:n})=>(0,c.request)(`${o}/deleteDoc/${n}`,{method:"DELETE"}),s=async o=>{try{return await(0,c.request)(`/${g.Z}/getInfos`,{method:"GET"})}catch{return o({type:"warning",message:{id:"notification.error"}}),null}},m=({prefix:o,version:n})=>(0,c.request)(`${o}/regenerateDoc`,{method:"POST",body:{version:n}}),y=({prefix:o,body:n})=>(0,c.request)(`${o}/updateSettings`,{method:"PUT",body:n});var l=t(798);const v=()=>{const o=(0,e.useQueryClient)(),n=(0,c.useNotification)(),{isLoading:p,data:O}=(0,e.useQuery)("get-documentation",()=>s(n)),h=r=>{n({type:"warning",message:r.response.payload.message})},E=(r,M)=>{o.invalidateQueries("get-documentation"),n({type:r,message:{id:(0,l.Z)(M)}})},A=(0,e.useMutation)(i,{onSuccess:()=>E("info","notification.delete.success"),onError:r=>h(r)}),a=(0,e.useMutation)(y,{onSuccess:()=>E("success","notification.update.success"),onError:h}),u=(0,e.useMutation)(m,{onSuccess:()=>E("info","notification.generate.success"),onError:r=>h(r)});return{data:O,isLoading:p,deleteMutation:A,submitMutation:a,regenerateDocMutation:u}}},798:(S,d,t)=>{t.d(d,{Z:()=>g});var e=t(49950);const g=i=>`${e.Z}.${i}`},93742:(S,d,t)=>{t.d(d,{O:()=>e.Z});var e=t(798)}}]);
