"use strict";(self.webpackChunkbe=self.webpackChunkbe||[]).push([[9789],{75730:(T,g,n)=>{n.r(g),n.d(g,{default:()=>v});var e=n(67294),d=n(97132),l=n(95489),E=n(15482),t=n(28702),m=n(41363),h=n(80826),c=n(93742),p=n(96486);const u=a=>{const o=(()=>(0,p.startsWith)(a,"/")?`${strapi.backendURL}${a}`:(0,p.startsWith)(a,"https")||(0,p.startsWith)(a,"http")?a:`${strapi.backendURL}/${a}`)();return window.open(o,"_blank"),window.focus()};var r=n(4733);const v=()=>{(0,l.useFocusWhenNavigate)();const{formatMessage:a}=(0,d.useIntl)(),{data:o,isLoading:y,deleteMutation:P,regenerateDocMutation:C}=(0,r.Z)(),[i,f]=(0,e.useState)(!1),[B,O]=(0,e.useState)(!1),[S,I]=(0,e.useState)(),R=4,b=(o?.docVersions?.length||0)+1,$=()=>{const s=o?.prefix.startsWith("/")?"":"/";u(`${s}${o?.prefix}/v${o?.currentVersion}`)},W=s=>{C.mutate({version:s,prefix:o?.prefix})},Z=()=>{f(!i)},V=async()=>{O(!0),await P.mutateAsync({prefix:o?.prefix,version:S}),f(!i),O(!1)},x=s=>{I(s),f(!i)},L=a({id:(0,c.O)("plugin.name"),defaultMessage:"Documentation"});return e.createElement(t.Layout,null,e.createElement(E.Helmet,{title:L}),e.createElement(t.Main,{"aria-busy":y},e.createElement(t.HeaderLayout,{title:L,subtitle:a({id:(0,c.O)("pages.PluginPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:e.createElement(l.CheckPermissions,{permissions:h.Z.open},e.createElement(t.Button,{onClick:$,startIcon:e.createElement(m.Eye,null)},a({id:(0,c.O)("pages.PluginPage.Button.open"),defaultMessage:"Open Documentation"})))}),e.createElement(t.ContentLayout,null,y&&e.createElement(l.LoadingIndicatorPage,null,"Plugin is loading"),o?.docVersions.length?e.createElement(t.Table,{colCount:R,rowCount:b},e.createElement(t.Thead,null,e.createElement(t.Tr,null,e.createElement(t.Th,null,e.createElement(t.Typography,{variant:"sigma",textColor:"neutral600"},a({id:(0,c.O)("pages.PluginPage.table.version"),defaultMessage:"Version"}))),e.createElement(t.Th,null,e.createElement(t.Typography,{variant:"sigma",textColor:"neutral600"},a({id:(0,c.O)("pages.PluginPage.table.generated"),defaultMessage:"Last Generated"}))))),e.createElement(t.Tbody,null,o.docVersions.sort((s,Q)=>s.generatedDate<Q.generatedDate?1:-1).map(s=>e.createElement(t.Tr,{key:s.version},e.createElement(t.Td,{width:"50%"},e.createElement(t.Typography,null,s.version)),e.createElement(t.Td,{width:"50%"},e.createElement(t.Typography,null,s.generatedDate)),e.createElement(t.Td,null,e.createElement(t.Flex,{justifyContent:"end",...l.stopPropagation},e.createElement(t.IconButton,{onClick:$,noBorder:!0,icon:e.createElement(m.Eye,null),label:a({id:(0,c.O)("pages.PluginPage.table.icon.show"),defaultMessage:"Open {target}"},{target:`${s.version}`})}),e.createElement(l.CheckPermissions,{permissions:h.Z.regenerate},e.createElement(t.IconButton,{onClick:()=>W(s.version),noBorder:!0,icon:e.createElement(m.Refresh,null),label:a({id:(0,c.O)("pages.PluginPage.table.icon.regenerate"),defaultMessage:"Regenerate {target}"},{target:`${s.version}`})})),e.createElement(l.CheckPermissions,{permissions:h.Z.update},s.version!==o.currentVersion&&e.createElement(t.IconButton,{onClick:()=>x(s.version),noBorder:!0,icon:e.createElement(m.Trash,null),label:a({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${s.version}`})})))))))):e.createElement(l.EmptyStateLayout,null)),e.createElement(l.ConfirmDialog,{isConfirmButtonLoading:B,onConfirm:V,onToggleDialog:Z,isOpen:i})))}},4733:(T,g,n)=>{n.d(g,{Z:()=>D});var e=n(23724),d=n(95489),l=n(49950);const E=({prefix:u,version:r})=>(0,d.request)(`${u}/deleteDoc/${r}`,{method:"DELETE"}),t=async u=>{try{return await(0,d.request)(`/${l.Z}/getInfos`,{method:"GET"})}catch{return u({type:"warning",message:{id:"notification.error"}}),null}},m=({prefix:u,version:r})=>(0,d.request)(`${u}/regenerateDoc`,{method:"POST",body:{version:r}}),h=({prefix:u,body:r})=>(0,d.request)(`${u}/updateSettings`,{method:"PUT",body:r});var c=n(798);const D=()=>{const u=(0,e.useQueryClient)(),r=(0,d.useNotification)(),{isLoading:M,data:v}=(0,e.useQuery)("get-documentation",()=>t(r)),a=i=>{r({type:"warning",message:i.response.payload.message})},o=(i,f)=>{u.invalidateQueries("get-documentation"),r({type:i,message:{id:(0,c.Z)(f)}})},y=(0,e.useMutation)(E,{onSuccess:()=>o("info","notification.delete.success"),onError:i=>a(i)}),P=(0,e.useMutation)(h,{onSuccess:()=>o("success","notification.update.success"),onError:a}),C=(0,e.useMutation)(m,{onSuccess:()=>o("info","notification.generate.success"),onError:i=>a(i)});return{data:v,isLoading:M,deleteMutation:y,submitMutation:P,regenerateDocMutation:C}}},798:(T,g,n)=>{n.d(g,{Z:()=>l});var e=n(49950);const l=E=>`${e.Z}.${E}`},93742:(T,g,n)=>{n.d(g,{O:()=>e.Z});var e=n(798)}}]);
